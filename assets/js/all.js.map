{"version":3,"sources":["all.js"],"names":["countries","document","querySelector","cyties","gpsIcon","menuIcon","map","L","center","zoom","tileLayer","attribution","addTo","axios","get","then","res","getGPS","navigator","geolocation","showPosition","position","setView","coords","latitude","longitude","showError","alert","getCurrentPosition","addEventListener","data","markers","MarkerClusterGroup","forEach","item","iconColor","total","Icon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","addLayer","marker","icon","bindPopup","storeNm","addr","tel","busiTime","updateTime","content","str","hsnNm","value","townNm","list","innerHTML","e","target","tagName","innerText","$","toggleClass","error","geoData","countriesOptions","cytiesOptions","index","CityName","selectedIndex","AreaList","AreaName","click"],"mappings":"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","file":"all.js","sourcesContent":["let countries = document.querySelector('#countries');\r\nlet cyties = document.querySelector('#cyties');\r\nlet gpsIcon = document.querySelector('#gpsIcon');\r\nlet menuIcon = document.querySelector('#menuIcon');\r\n\r\n//地圖初始化\r\nvar map = L.map(\"map\", {\r\n    center: [24.994579, 121.311088],\r\n    zoom: 8\r\n});\r\nL.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n}).addTo(map);\r\n\r\naxios.get(\"https://3000.gov.tw/hpgapi-openmap/api/getPostData\")\r\n    .then((res) => {\r\n        //處理自動定位\r\n        function getGPS() {\r\n            if (navigator.geolocation) {\r\n                // 成功\r\n                function showPosition(position) {\r\n                    map.setView([position.coords.latitude, position.coords.longitude], 15);\r\n                }\r\n                // 失敗\r\n                function showError() {\r\n                    alert('抱歉，現在無法取的您的地理位置。')\r\n                }\r\n                navigator.geolocation.getCurrentPosition(showPosition, showError);\r\n            } else {\r\n                alert('抱歉，您的裝置不支援定位功能。');\r\n            }\r\n        }\r\n        getGPS();\r\n        gpsIcon.addEventListener('click', getGPS, false);\r\n\r\n        // 處理地圖\r\n        let data = res.data;\r\n        var markers = new L.MarkerClusterGroup().addTo(map);\r\n        data.forEach((item) => {\r\n\r\n            //判斷標點顏色\r\n            const iconColor = (() => {\r\n                if (item.total !== 0) {\r\n                    return new L.Icon({\r\n                        iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',\r\n                        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\r\n                        iconSize: [25, 41],\r\n                        iconAnchor: [12, 41],\r\n                        popupAnchor: [1, -34],\r\n                        shadowSize: [41, 41]\r\n                    });\r\n                } else {\r\n                    return new L.Icon({\r\n                        iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\r\n                        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\r\n                        iconSize: [25, 41],\r\n                        iconAnchor: [12, 41],\r\n                        popupAnchor: [1, -34],\r\n                        shadowSize: [41, 41]\r\n                    });\r\n                }\r\n            })();\r\n\r\n            //群組標點.增加圖層(leaflet的標點([座標])).增加popup\r\n            markers.addLayer(\r\n                L.marker([item.latitude, item.longitude], {\r\n                    icon: iconColor\r\n                }).bindPopup(`<div>\r\n                <h4 class=\"m-0 mb-2 bold\">${item.storeNm}</h4>\r\n                <p class=\"m-0 mb-2 h5 text-danger\"><span class=\"bold\">三倍券庫存量：</span>${item.total}</p>\r\n                <a target=\"_blank\" href=\"https://www.google.com.tw/maps/place/${item.addr}\" class=\"m-0 mb-2 h6 text-dark underLine\"><span class=\"bold\">地址：</span>${item.addr}</a>                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">電話：</span>${item.tel}</p>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">營業時間：</span>${item.busiTime}</p>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">數據更新時間：</span>${item.updateTime}</p>\r\n                </div>`)\r\n            );\r\n        });\r\n        map.addLayer(markers);\r\n\r\n        //選取地區後的資料顯示\r\n        countries.addEventListener('change', function () {\r\n            let content = '';\r\n            let str = '';\r\n            data.forEach(item => {\r\n                if (item.hsnNm == countries.value && item.townNm == cyties.value) {\r\n                    content = `<li> <div class=\"card p-2 mb-2\">\r\n                <h4 class=\"btn btn-primary m-0 mb-2 bold\">${item.storeNm}</h4>\r\n                <p class=\"m-0 mb-2 h5 text-danger\"><span class=\"bold\">三倍券庫存量：</span>${item.total}</p>\r\n                <a target=\"_blank\" href=\"https://www.google.com.tw/maps/place/${item.addr}\" class=\"m-0 mb-2 h6 text-dark underLine\"><span class=\"bold\">地址：</span>${item.addr}</a>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">電話：</span>${item.tel}</p>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">營業時間：</span>${item.busiTime}</p>\r\n                </div> </li>`;\r\n                    str += content;\r\n                }\r\n            })\r\n            list.innerHTML = str;\r\n        })\r\n        cyties.addEventListener('change', function () {\r\n            let content = '';\r\n            let str = '';\r\n            data.forEach(item => {\r\n                if (item.hsnNm == countries.value && item.townNm == cyties.value) {\r\n                    content = `<li> <div class=\"card p-1 mb-2\">\r\n                <h4 class=\"btn btn-primary m-0 mb-2 bold\">${item.storeNm}</h4>\r\n                <p class=\"m-0 mb-2 h5 text-danger\"><span class=\"bold\">三倍券庫存量：</span>${item.total}</p>\r\n                <a target=\"_blank\" href=\"https://www.google.com.tw/maps/place/${item.addr}\" class=\"m-0 mb-2 h6 text-dark underLine\"><span class=\"bold\">地址：</span>${item.addr}</a>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">電話：</span>${item.tel}</p>\r\n                <p class=\"m-0 mb-2 h6\"><span class=\"bold\">營業時間：</span>${item.busiTime}</p>\r\n                </div> </li>`;\r\n                    str += content;\r\n                }\r\n            })\r\n            list.innerHTML = str;\r\n        })\r\n        //點擊郵局標題移動位置\r\n        list.addEventListener('click', function (e) {\r\n            if (e.target.tagName == 'H4') {\r\n                // console.log(e.target.innerText);\r\n                data.forEach(item => {\r\n                    if (item.storeNm == e.target.innerText) {\r\n                        map.setView([item.latitude, item.longitude], 18);\r\n                    }\r\n                })\r\n                $('.navBar').toggleClass('show');\r\n            }\r\n        }, false)\r\n    })\r\n    .catch(function (error) {\r\n        alert(error);\r\n    })\r\n\r\n//製作縣市下拉選單\r\naxios.get('https://raw.githubusercontent.com/Feitoengineer19/mask-map/master/CityCountyData.json')\r\n    .then((res) => {\r\n        let geoData = res.data;\r\n        let countriesOptions = '';\r\n        let cytiesOptions = '';\r\n        countriesOptions = `<option value=\"\" selected disabled>請選擇縣市</option>`;\r\n        geoData.forEach((item, index) => {\r\n            countriesOptions += `<option value=\"${item.CityName}\">${item.CityName}</option>`;\r\n            // console.log(item.AreaList.forEach(item => {\r\n            //     console.log(item.AreaName);\r\n            // }));\r\n        })\r\n        countries.innerHTML = `<select name=\"\" id=\"countries\">${countriesOptions}</select>`;\r\n\r\n        countries.addEventListener('change', function () {\r\n            cytiesOptions = '';\r\n            cytiesOptions = `<option value=\"\" selected disabled>請選擇</option>`;\r\n            geoData[countries.selectedIndex - 1].AreaList.forEach(item => {\r\n                // console.log(item.AreaName);\r\n                cytiesOptions += `<option value=\"${item.AreaName}\">${item.AreaName}</option>`;\r\n            })\r\n            cyties.innerHTML = `<select name=\"\" id=\"countries\">${cytiesOptions}</select>`;\r\n        })\r\n    })\r\n\r\n//nav收合\r\n$('#menuIcon').click(function (e) {\r\n    $('.navBar').toggleClass('show');\r\n});\r\n$('#clearIcon').click(function (e) {\r\n    $('.navBar').toggleClass('show');\r\n});"]}